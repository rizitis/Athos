Packager="Anagnostakis Ioannis <rizitis@gmail.com> GR"

Homepage="https://www.videolan.org/vlc/"
        #|--------------------------------------|#
SortDesc="Multi-platform  player"
LongDesc="Multi-platform MPEG, VCD/DVD, and DivX player"
VERSION=3.0.21
PRGNAM=vlc
SRCNAM=vlc
# Source download link
SRCURL="https://download.videolan.org/vlc/$VERSION/vlc-$VERSION.tar.xz"
COMPRESS=tar.xz
GITCHEK=
# Empty if not mdsum check needed.
MDSCHK=
BIN_PKG=
# Add required and optional deps if needed in parenthesis. (foo foo1 foo2)
REQUIRED=
OPTDEPS=

BUILD=${BUILD:-1}
TAG=${TAG:-_rtz}


# This must be always here even if not patches needed.
patch_build() {
if [ -e $CWD/patches/ ]; then
  for PATCH in $CWD/patches/*.patch; do
    patch -p1 -i $PATCH
  done
fi
}


slackbuild() {
NOCONFIGURE=1 ./bootstrap
CFLAGS="$SLKCFLAGS -fcommon -O2 -flto=auto" \
CXXFLAGS="$SLKCFLAGS -flto=auto -O2" \
LDFLAGS="$SLKLDFLAGS" \
LUA=lua5.4 \
LUAC=luac5.4 \

  ./configure \
        --prefix=/usr \
        --libdir=/usr/lib${LIBDIRSUFFIX} \
        --sysconfdir=/etc \
        --mandir=/usr/man \
        --docdir=/usr/doc/vlc-$VERSION \
        --localstatedir=/var \
        --build=$ARCH-slackware-linux \
        --enable-qt=6 \
        --disable-nls \
        --disable-rpath \
		--disable-static \
		--enable-a52 \
		--enable-avcodec \
		--enable-avformat \
		--enable-bluray \
		--enable-dav1d \
		--enable-dbus \
		--enable-dc1394 \
		--enable-dvbpsi \
		--enable-dvdnav \
		--enable-dvdread \
		--enable-faad \
		--enable-flac \
		--enable-gnutls \
		--enable-libcddb \
		--enable-libplacebo \
		--enable-libva \
		--enable-live555 \
		--enable-merge-ffmpeg \
		--enable-ncurses \
		--enable-realrtsp \
		--enable-shout \
		--enable-skins2 \
		--enable-sout \
		--enable-speex \
		--enable-srt \
		--enable-taglib \
		--enable-theora \
		--enable-upnp \
		--enable-v4l2 \
		--enable-vdpau \
		--enable-vlm \
		--enable-vorbis \
		--enable-wma-fixed \
		--enable-x264 \
		--enable-xvideo

		make "$NUMJOBS"
		make -j1 DESTDIR=$PKG install
		rm -rf "$PKG"/usr/lib64/vlc/plugins/plugins.dat || true
        rm -rf "$PKG"/usr/lib/mozilla || true
        rm -rf "$PKG"/usr/share/kde4  || true
}

